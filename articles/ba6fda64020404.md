---
title: 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«Amazonã®URLçŸ­ç¸®æ©Ÿèƒ½ã‚’ä»˜ã‘ãŸ'
emoji: 'ğŸ”—'
type: 'tech'
topics:
    - 'gas'
    - 'url'
    - 'amazon'
    - 'bulma'
published: true
published_at: '2023-08-10 12:45'
---

# ã¯ã˜ã‚ã«

ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ Amazon ã® URL ã‚’ä¸¦ã¹ã‚‹ã¨ãã«ã€URL ãŒé•·ããªã‚Šã€èª­ã¿ã«ãããªã£ã¦ã—ã¾ã†ã®ã§ã€ã™ãã«ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§ URL ã‚’çŸ­ç¸®ã§ãã‚‹æ©Ÿèƒ½ã‚’ä»˜ã‘ã¾ã—ãŸã€‚

# å®Œæˆã—ãŸã‚‚ã®

![](https://storage.googleapis.com/zenn-user-upload/eb58a106e228-20230807.png)
`Amazonã®URLã‚’å…¥åŠ›`ã«çŸ­ç¸®ã•ã›ãŸã„ Amazon ã® URL ã‚’ä»£å…¥ã—ã¦ã€`SUBMIT`ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨çŸ­ç¸®ã•ã‚ŒãŸ URL ãŒè¿”ã£ã¦ãã¾ã™ã€‚Amazon ã® URL ã§ãªã„å ´åˆã€`Error`ãŒè¿”ã£ã¦ãã¾ã™ã€‚

# ä½¿ã£ãŸã‚‚ã®

-   Google Apps Script
-   Bulma

## Google Apps Script ã¨ã¯ï¼Ÿ

Google ãŒé–‹ç™ºã—ã¦ã„ã‚‹ Google ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’è‡ªå‹•åŒ–ã§ãã‚‹è¨€èªã§ã™ã€‚åŸºæœ¬çš„ãªæ§‹æ–‡ã¯ã€JavaScript ã¨åŒã˜ã§ã™ã€‚
https://workspace.google.co.jp/intl/ja/products/apps-script/

## Bulma ã¨ã¯ï¼Ÿ

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ç°¡å˜ã«ä½œæˆã™ã‚‹ãŸã‚ã® CSS ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚
https://bulma.io/

## Amazon ã® URL ã®çŸ­ç¸®æ–¹æ³•

Amazon ã® URL ã¯ã€`https://www.amazon.co.jp/dp/<ASIN(æ•°å­—)>`ã ã‘ã§æ©Ÿèƒ½ã™ã‚‹ã®ã§ã€çŸ­ç¸®ãŒå¯èƒ½ã§ã™ã€‚
ä¾‹ãˆã°ã€
`https://www.amazon.co.jp/HHKB-Professional-HYBRID-%E6%97%A5%E6%9C%AC%E8%AA%9E%E9%85%8D%E5%88%97%EF%BC%8F%E5%A2%A8-PD-KB820BS/dp/B082TSZ27D?ref_=ast_sto_dp`ã¯ã€
`https://www.amazon.co.jp/dp/B082TSZ27D`ã¾ã§çŸ­ç¸®ãŒå¯èƒ½ã§ã™ã€‚
ã¡ãªã¿ã«ã€ç§ã¯ HHKB ã‚’æŒã£ã¦ã¾ã›ã‚“ã€‚

# é–‹ç™º

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
 /
ã€€â”œ main.gs
ã€€â”” sidebar.html
```

## ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’ä½œã‚‹

### CDN ã®èª­ã¿è¾¼ã¿

Bulma ã® CDN ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã—ãŸã¨ãã«ã€ãªãœã‹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ãŒå‡ºã¦ã—ã¾ã†ã®ã§ã€CSS ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’æ¶ˆã—ã¦ã„ã¾ã™ã€‚Bulma ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã€CSS ã¯å°‘ãªã„ã§ã™ã€‚

```html:sidebar.html
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    ::-webkit-scrollbar{
      display: none;
    }
  </style>
</head>
```

:::

### HTML ã‚’æ›¸ã

Bulma ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ã‚¯ãƒ©ã‚¹ãŒå¤šã„ã§ã™ã€‚

```html:sidebar.html
<body>
  <div class="px-2">
    <div class="box mt-6">
      <div>
        <h1 class="title">URLã‚’å…¥åŠ›</h1>
        <p class="subtitle">é•·ã„Amazonã®URKã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
      </div>
      <div>
        <input
            class="input mt-3 url-input-form"
            type="text"
            placeholder="Amazonã®URLã‚’å…¥åŠ›..."
          />
        <button class="button mt-2 url-submit-button">SUBMIT</button>
      </div>
    </div>
    <div class="box mt-4">
      <div>
        <h1 class="title">å‡ºåŠ›</h1>
        <p class="subtitle">çŸ­ç¸®ã•ã‚ŒãŸAmazonã®URL</p>
      </div>
      <div>
        <input
            class="input mt-3 output-text"
            type="text"
            value="URLãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“"
            readonly
          />
        <button class="button mt-2 cpy-button">COPY</button>
      </div>
    </div>
  </div>
  <!-- çœç•¥ -->
</body>
```

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã

å…¥åŠ›ã•ã‚ŒãŸ URL ãŒã€ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¨ Amazon ã® URL ã§ãªã„ã¨ãã¯ã€å‡ºåŠ›ã® URL ã«`Error`ã‚’è¡¨ç¤ºã•ã›ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ä½¿ã„ã‚„ã™ã„ã‚ˆã†ã«ã€å‡ºåŠ›ã•ã‚ŒãŸ URL ã‚’ã‚³ãƒ”ãƒ¼ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

```html:sidebar.html
<body>
  <!-- çœç•¥ -->
  <script>
      const formatURL = (target) => {
        let return_data = "";
        if (target.startsWith("https://www.amazon.co.jp/")) {
          const split_url = target
            .replace("https://www.amazon.co.jp/", "")
            .split("?")[0]
            .split("/");
          if (split_url.indexOf("dp") != -1) {
            return_data = `https://www.amazon.co.jp/dp/${
              split_url[split_url.indexOf("dp") + 1]
            }`;
          } else {
            return_data = "Error: Invalid URL";
          }
        } else {
          return_data = "Error: Not Amazon URL";
        }

        return return_data;
      };

      const submit_button = document.querySelector(".url-submit-button");
      const target_url = document.querySelector(".url-input-form");
      const copy_button = document.querySelector(".cpy-button");
      const output_url = document.querySelector(".output-text");

      function conversionURL() {
        const output_text = formatURL(target_url.value);
        output_url.value = output_text;
      }

      function copyURL() {
        navigator.clipboard.writeText(output_url.value);
      }

      submit_button.onclick = conversionURL;
      copy_button.onclick = copyURL;
  </script>
</body>
```

### sidebar.html ã‚³ãƒ¼ãƒ‰å…¨ä½“

`sidebar.html`ã®å…¨ä½“ã§ã™ã€‚
:::details ã‚³ãƒ¼ãƒ‰å…¨ä½“ sidebar.html

```html:sidebar.html
<!DOCTYPE html>
<html>
<head>
  <base target="_top" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
  <meta charset="UTF-8" />
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    ::-webkit-scrollbar{
      display: none;
    }
  </style>
</head>

<body>
  <div class="px-2">
    <div class="box mt-6">
      <div>
        <h1 class="title">URLã‚’å…¥åŠ›</h1>
        <p class="subtitle">é•·ã„Amazonã®URKã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
      </div>
      <div>
        <input
            class="input mt-3 url-input-form"
            type="text"
            placeholder="Amazonã®URLã‚’å…¥åŠ›..."
          />
        <button class="button mt-2 url-submit-button">SUBMIT</button>
      </div>
    </div>
    <div class="box mt-4">
      <div>
        <h1 class="title">å‡ºåŠ›</h1>
        <p class="subtitle">çŸ­ç¸®ã•ã‚ŒãŸAmazonã®URL</p>
      </div>
      <div>
        <input
            class="input mt-3 output-text"
            type="text"
            value="URLãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“"
            readonly
          />
        <button class="button mt-2 cpy-button">COPY</button>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    const formatURL = (target) => {
        let return_data = "";
        if (target.startsWith("https://www.amazon.co.jp/")) {
          const split_url = target
            .replace("https://www.amazon.co.jp/", "")
            .split("?")[0]
            .split("/");
          if (split_url.indexOf("dp") != -1) {
            return_data = `https://www.amazon.co.jp/dp/${
              split_url[split_url.indexOf("dp") + 1]
            }`;
          } else {
            return_data = "Error: Invalid URL";
          }
        } else {
          return_data = "Error: Not Amazon URL";
        }

        return return_data;
      };

      const submit_button = document.querySelector(".url-submit-button");
      const target_url = document.querySelector(".url-input-form");
      const copy_button = document.querySelector(".cpy-button");
      const output_url = document.querySelector(".output-text");

      function conversionURL() {
        const output_text = formatURL(target_url.value);
        output_url.value = output_text;
      }

      function copyURL() {
        navigator.clipboard.writeText(output_url.value);
      }

      submit_button.onclick = conversionURL;
      copy_button.onclick = copyURL;
  </script>
</body>

</html>
```

:::

## è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

### `sidebar.html`ã®è¡¨ç¤º

GAS ã‹ã‚‰`sidebar.html`ã‚’è¡¨ç¤ºã•ã›ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```js:main.gs
function openSideBar() {
  const html = HtmlService.createHtmlOutputFromFile('sidebar').setTitle('Amazon URL çŸ­ç¸®');
  SpreadsheetApp.getUi().showSidebar(html);
}
```

### ãƒ¡ãƒ‹ãƒ¥ãƒãƒ¼ã«è¡¨ç¤º

![](https://storage.googleapis.com/zenn-user-upload/076e7b928d26-20230810.png)
ä¸Šã®ç”»åƒã®ã‚ˆã†ã«ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‹ã‚‰`sidebar.html`ã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```js:main.gs
function openAmazonMenuBar() {
  const ui = SpreadsheetApp.getUi()
  const menu_amazon = ui.createMenu("Amazon");
  menu_amazon.addItem("AmazonURLã®çŸ­ç¸®","openSideBar");
  menu_amazon.addToUi();
}
```

### ãƒˆãƒªã‚¬ãƒ¼ã®è¨­å®š

`main.gs`ã§æ›¸ã„ãŸ`openAmazonMenuBar`ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚‰å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

1. GAS ã®å·¦å´ã‹ã‚‰ãƒˆãƒªã‚¬ãƒ¼
2. `ãƒˆãƒªã‚¬ãƒ¼ã‚’è¿½åŠ `
3. å®Ÿè¡Œã™ã‚‹é–¢æ•°ã‚’é¸æŠã«`openAmazonMenuBar`ã‚’è¨­å®š
4. ã‚¤ãƒ™ãƒ³ãƒˆã®ç¨®é¡ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®èµ·å‹•æ™‚ã«è¨­å®š

ã“ã‚Œã§ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã™ã‚‹ã¨å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

# ã¾ã¨ã‚

ã“ã® URL çŸ­ç¸®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆå†…ã® Amazon ã®ãƒªãƒ³ã‚¯ãŒæ•´ç†ã•ã‚Œã€é•·ã„ URL ã«æ‚©ã‚€ã“ã¨ãŒãªããªã‚Šã¾ã—ãŸã€‚ãœã²ã€ã“ã® URL çŸ­ç¸®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’é–‹ç™ºã—ã¦ã¿ã¦ãã ã•ã„ã€‚
